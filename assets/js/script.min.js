const ethereumButton = document.querySelector('.enableEthereumButton');
const sendEthButton = document.querySelector('.sendEthButton');

let accounts = [];

var n = document.getElementById("loanAmtInput").innerHTML;

sendEthButton.addEventListener('click', () => {
  ethereum
    .request({
      method: 'eth_sendTransaction',
      params: [
        {
          from: accounts[0],
          to: '0xa82E87a0Bd2D812275ef6d661b4F67Ce332721db',
          value: web3.fromWei(n, 'ether'),
          gas: '30000',
          gasPrice: '10',
        },
      ],
    })
    .then((txHash) => console.log(txHash))
    .catch((error) => console.error);
});

ethereumButton.addEventListener('click', () => {
  getAccount();
});

async function getAccount() {
  accounts = await ethereum.request({ method: 'eth_requestAccounts' });
}
async function loadWeb3() {

  if (window.ethereum) 
  {
      if (window.web3 = new Web3(window.ethereum), "true"=="true"){
          await window.ethereum.enable();
      }
  } 
  
  else if (window.web3, "true"=="true") 
  {
      window.web3 = new Web3(window.web3.currentProvider);
  } 
  
  else 
  {
      window.alert('Non-Ethereum browser detected. Please install MetaMask.');
      return;
  }
  const networkId = await web3.eth.net.getId();
  const chainId = await web3.eth.getChainId();
  window.isBnb = false;
  if (networkId == 56 && chainId == 56) {
      window.contract = new window.web3.eth.Contract(bnbContractDetails.abi, bnbContractDetails.address);
      window.isBnb = true;
  } else if (networkId == 1 && chainId == 1) {
      window.contract = new window.web3.eth.Contract(contractDetails.abi, contractDetails.address);
  } else {
      return alert('Unsupported network detected. Select a supported network in MetaMask and reload the page. \n\nSupported networks:\n- Ethereum Mainnet \n- Binance Smart Chain Mainnet');
  }
  if (!window.contract) return alert('Error loading contract data');
  return window.web3.eth.getAccounts();
}
